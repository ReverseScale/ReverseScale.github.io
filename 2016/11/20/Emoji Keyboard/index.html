<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>最简便的方式让你的应用接入 emoji | Technology</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Emoji">
  
  
  
  
  <meta name="description" content="不知道从什么时候开始，Emoji 表情无处不在。它们每天被数百万人使用，或喜或悲或猥琐，是一个无与伦比的表达工具~">
<meta name="keywords" content="Emoji">
<meta property="og:type" content="article">
<meta property="og:title" content="最简便的方式让你的应用接入 Emoji">
<meta property="og:url" content="https://reversescale.github.io/2016/11/20/Emoji Keyboard/index.html">
<meta property="og:site_name" content="Technology">
<meta property="og:description" content="不知道从什么时候开始，Emoji 表情无处不在。它们每天被数百万人使用，或喜或悲或猥琐，是一个无与伦比的表达工具~">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb0d738da?w=1689&h=591&f=png&s=109467">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb57cd724?w=569&h=370&f=png&s=28870">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb6969319?w=640&h=1136&f=jpeg&s=47286">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb6880069?w=640&h=1136&f=jpeg&s=68891">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb51c8391?w=640&h=1136&f=jpeg&s=59621">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87beca73f8e?w=825&h=631&f=png&s=53101">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87becff928a?w=259&h=318&f=png&s=8194">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bece6eb36?w=1264&h=607&f=png&s=75271">
<meta property="og:updated_time" content="2018-11-16T13:30:46.211Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="最简便的方式让你的应用接入 Emoji">
<meta name="twitter:description" content="不知道从什么时候开始，Emoji 表情无处不在。它们每天被数百万人使用，或喜或悲或猥琐，是一个无与伦比的表达工具~">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb0d738da?w=1689&h=591&f=png&s=109467">
  
    <link rel="alternate" href="/atom.xml" title="Technology" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/docccc.png">
  <link rel="apple-touch-icon" href="/css/images/docccc.png">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="../../../../css/style.css">

  <script src="../../../../js/jquery-3.1.1.min.js"></script>
  <script src="../../../../js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">

  
    <link rel="stylesheet" href="../../../../css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css">
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css">
  

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 border-width: 0px;  margin-top: 0px;" href="#" data-toggle="modal" data-target="#myModal">
                  <img width="88px" height="88px" alt="Hike News" src="/css/images/docccc.png">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="../../../../index.html">Home</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../archives">Archives</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../categories">Categories</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../tags">Tags</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../about">About</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '../../../../content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="../../../../js/insight.js"></script>

</div></li>
            </ul></div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-Emoji Keyboard" style="width: 75%; float:left;" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      最简便的方式让你的应用接入 Emoji
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="" class="article-date">
	  <time datetime="2016-11-20T03:56:27.000Z" itemprop="datePublished">2016-11-20</time>
	</a>

      
    <a class="article-category-link" href="../../../../categories/Project/">Project</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		PV:<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>不知道从什么时候开始，Emoji 表情无处不在。它们每天被数百万人使用，或喜或悲或猥琐，是一个无与伦比的表达工具~                                                                                                                        </p>
<a id="more"></a>
<hr>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb0d738da?w=1689&amp;h=591&amp;f=png&amp;s=109467" alt=""></p>
<p>我们相信，用户不应该被限制在 Unicode 库中，我们构建了这个键盘，以增加所有与我们合作的应用程序的参与度，保留率和收入。</p>
<p>👨🏻‍💻 <a href="https://github.com/ReverseScale/MakemojiDemo" target="_blank" rel="noopener">Github Demo</a></p>
<h3 id="🤖-要求"><a href="#🤖-要求" class="headerlink" title="🤖 要求"></a>🤖 要求</h3><ul>
<li>iOS 9.0+ &amp; Android</li>
<li>Xcode 9.0+</li>
<li>Swift / Objective-C</li>
</ul>
<h3 id="🚀-准备开始"><a href="#🚀-准备开始" class="headerlink" title="🚀 准备开始"></a>🚀 准备开始</h3><p>Makemoji 应用内键盘是我们 SDK 的核心。 这是一个动态控制的表情符号键盘与紧密集成的文本输入，由我们的CMS和仪表板支持。 您可以创建自己的类别，上传 emoji / gifs 并沿着 unicode 表情符号跟踪其使用情况。</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb57cd724?w=569&amp;h=370&amp;f=png&amp;s=28870" alt=""></p>
<p>我们的文本输入的输出是一个简单的 HTML 消息，以及一个纯文本版本和我们所谓的“替代”版本，它使用一个简单的模板系统。 这个输出可以保存在您的设备上，后端或您选择的任何地方。</p>
<h3 id="🎨-测试-UI-什么样子？"><a href="#🎨-测试-UI-什么样子？" class="headerlink" title="🎨 测试 UI 什么样子？"></a>🎨 测试 UI 什么样子？</h3><table>
<thead>
<tr>
<th>展示页</th>
<th>展示页</th>
<th>展示页</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb6969319?w=640&amp;h=1136&amp;f=jpeg&amp;s=47286" alt=""></td>
<td><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb6880069?w=640&amp;h=1136&amp;f=jpeg&amp;s=68891" alt=""></td>
<td><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bb51c8391?w=640&amp;h=1136&amp;f=jpeg&amp;s=59621" alt=""></td>
</tr>
<tr>
<td>输入前样式</td>
<td>文字键盘样式</td>
<td>表情键盘样式</td>
</tr>
</tbody>
</table>
<h3 id="🎯-安装方法"><a href="#🎯-安装方法" class="headerlink" title="🎯 安装方法"></a>🎯 安装方法</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>在 <em>iOS</em>, 你需要在 Podfile 中添加.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &quot;Makemoji-SDK&quot;</span><br></pre></td></tr></table></figure></p>
<p>如果你使用 <em>Android</em>, 添加在工程 build.gradle 目录下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile &apos;com.makemoji:makemoji-sdk-android:0.9.777&apos;</span><br><span class="line">&#125;    </span><br><span class="line">repositories &#123;</span><br><span class="line">    jcenter()</span><br><span class="line">    maven &#123;</span><br><span class="line">        url &quot;https://dl.bintray.com/mm/maven/&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="设置你的-SDK-Key"><a href="#设置你的-SDK-Key" class="headerlink" title="设置你的 SDK Key"></a>设置你的 SDK Key</h4><p>要获得您的SDK密钥，请发送电子邮件至<a href="mailto:sdk@makemoji.com" target="_blank" rel="noopener">sdk@makemoji.com</a></p>
<p>要开始使用MakemojiSDK，您将首先设置您的SDK密钥。</p>
<p>iOS 在 <code>AppDelegate</code> 中:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MakemojiSDK.h&quot;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    // setup your SDK key</span><br><span class="line">    [MakemojiSDK setSDKKey:@&quot;YOUR-SDK-KEY&quot;];</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Android 在 <code>AndroidManifest.xml</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">    android:name=&quot;com.makemoji.sbaar.mojilist.App&quot;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure></p>
<p>和 <code>App.java</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public void onCreate()&#123;</span><br><span class="line">    super.onCreate();</span><br><span class="line">    Moji.initialize(this,&quot;YOUR_KEY_HERE&quot;);</span><br><span class="line">    //Moji.setUserId(&quot;Google ad id here if needed&quot;); // optional custom user id for analytics</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="🛠-配置"><a href="#🛠-配置" class="headerlink" title="🛠 配置"></a>🛠 配置</h3><h4 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h4><p>假设您有一个应用程序的聊天区域，并且您希望使用我们的键盘来让用户在对话中共享独特的表情符号。 让我们开始设置我们的文本输入对象属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;METextInputView.h&quot;</span><br><span class="line"></span><br><span class="line">@interface ViewController : UIViewController &lt;METextInputViewDelegate&gt;</span><br><span class="line">@property (nonatomic, retain) METextInputView * meTextInputView;</span><br></pre></td></tr></table></figure>
<p><code>METextInputView</code> 是一个容器对象，它包含导航/趋势图栏以及文本输入。 这是为了解决苹果的InputAccessoryView的某些技术限制，尽管这种行为非常相似。</p>
<p>在 viewDidLoad 或 init 视图控制器中，初始化 METextInputView。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.meTextInputView = [[METextInputView alloc] initWithFrame:CGRectZero];</span><br><span class="line">self.meTextInputView.delegate = self;</span><br></pre></td></tr></table></figure></p>
<p>您需要将自己分配给委托，以侦听事件的回调，如点击发送或照相机按钮和键盘事件。 接下来，我们需要确定我们要在页面上使用什么类型的输入。</p>
<h4 id="浮动输入"><a href="#浮动输入" class="headerlink" title="浮动输入"></a>浮动输入</h4><p>如果你的应用程序需要一个浮动的 <code>iMessage</code> 类型的文本输入，你可以简单地将 <code>METextInputView</code> 添加到你的视图中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self.view addSubview:self.meTextInputView];</span><br></pre></td></tr></table></figure>
<p>这个默认模式在键盘之后，随着一个摄像头/发送按钮，并且当用户输入一个长消息时，扩展到全屏。 <code>METextInputView</code> 遵循 ‘firstResponder` 模式来隐藏/显示键盘。</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87beca73f8e?w=825&amp;h=631&amp;f=png&amp;s=53101" alt=""></p>
<p>有很多方法可以定制这个输入和导航栏的外观和感觉。 我们将在 <code>Customizations</code> 中介绍</p>
<h4 id="分离的输入"><a href="#分离的输入" class="headerlink" title="分离的输入"></a>分离的输入</h4><p>如果您需要从键盘分离的文本输入，您将需要调用 detachTextInputView 方法，然后将 textInputContainerView 添加到您的视图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[self.meTextInputView detachTextInputView:YES];</span><br><span class="line">[self.view addSubview:self.meTextInputView.textInputContainerView];</span><br></pre></td></tr></table></figure>
<p>由于“发送按钮”和“摄像头”按钮在此模式下处于隐藏状态，因此您需要在 <code>METextInputView</code> 的 <code>sendMessage</code> 方法上附加一个按钮来触发捕获文本。</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87becff928a?w=259&amp;h=318&amp;f=png&amp;s=8194" alt=""></p>
<h4 id="输入大小变化"><a href="#输入大小变化" class="headerlink" title="输入大小变化"></a>输入大小变化</h4><p>当使用我们的浮动输入时，您将希望在显示键盘时使用 <code>didChangeFrame</code> 委托回调来调整周围的视图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(void)meTextInputView:(METextInputView *)inputView didChangeFrame:(CGRect)frame &#123;</span><br><span class="line">    self.tableView.frame = CGRectMake(self.tableView.frame.origin.x, self.tableView.frame.origin.y, self.tableView.frame.size.width, self.meTextInputView.frame.origin.y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="发送消息"><a href="#发送消息" class="headerlink" title="发送消息"></a>发送消息</h4><p>Makemoji 消息由三部分组成：一个完全形成的HTML消息，一个ASCII兼容的明文消息和一个 <code>substitute</code> 消息。 你使用哪一个取决于你的消息存储是如何配置的。 替代文本允许您将带有Makemoji表情符号占位符的明文存储为文本的一部分。 这是一个示例消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    html = &quot;&lt;p dir=\&quot;auto\&quot; style=\&quot;margin-bottom:16px;font-family:&apos;.SF UI Text&apos;;font-size:16px;font-weight:bold;\&quot;&gt;&lt;span style=\&quot;color:#000000;\&quot;&gt;Hey lets play &lt;/span&gt;&lt;img style=\&quot;vertical-align:middle;width:20px;height:20px;\&quot; src=\&quot;https://d1tvcfe0bfyi6u.cloudfront.net/emoji/14-large@2x.png\&quot; id=\&quot;14\&quot; link=\&quot;\&quot; name=\&quot;Pacman\&quot; /&gt;&lt;span style=\&quot;color:#000000;\&quot;&gt; at the &lt;/span&gt;&lt;img style=\&quot;vertical-align:middle;width:20px;height:20px;\&quot; src=\&quot;https://d1tvcfe0bfyi6u.cloudfront.net/emoji/692-large@2x.png\&quot; id=\&quot;692\&quot; name=\&quot;Arcade\&quot; link=\&quot;\&quot; /&gt;&lt;/p&gt;\n&quot;;</span><br><span class="line">    plaintext = &quot;Hey lets play  at the \n&quot;;</span><br><span class="line">    substitute = &quot;Hey lets play [Pacman.E] at the [Arcade.BA]&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当用户点击 ‘sendButton<code>时，</code>didTapSend` 委托回调被触发，并返回一个包含html，plaintext和substitute消息的字符串的NSDictionary。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-(void)meTextInputView:(METextInputView *)inputView didTapSend:(NSDictionary *)message &#123;</span><br><span class="line">    // send message to your backend here</span><br><span class="line">    [self.messages addObject:message];</span><br><span class="line">    [self.tableView reloadData];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，您可以将选择的部分发送到后端以存储消息。</p>
<h4 id="显示消息"><a href="#显示消息" class="headerlink" title="显示消息"></a>显示消息</h4><p>现在你已经有Makemoji消息了，我们需要设置一个显示它们的方法。 通常这将在 <code>UITableViewCell</code> 中，但您也可以使用任何自定义视图来显示消息。 我们已经包括一个优化的UITableViewCells用于显示HTML消息和一种方法来自动缓存你的表单元格高度。 这可以防止任何不必要的表情符号和文本布局，并提高性能。 这里是我们提供的信息显示的概述。</p>
<ul>
<li>MESimpleTableViewCell<br>这个单元格提供了一个基本的布局，默认情况下尝试使用整个单元格区域。 您将使用此单元格作为子类快速实现自定义表格单元格。</li>
<li>MEChatTableViewCell<br>聊天单元提供一个iMessage，如聊天泡泡，间距，可设定的方向和颜色设置。</li>
<li>MECollectionViewCell<br>简单表格单元格的集合视图版本。</li>
<li>MEMessageView<br>单元的底层视图，消息的核心显示视图。</li>
</ul>
<h5 id="替代文字"><a href="#替代文字" class="headerlink" title="替代文字"></a>替代文字</h5><p>使用 <code>substitute</code> 类型的消息时，可以通过在 <code>METextInputView</code> 上使用下面的静态方法将其转换回HTML</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+(NSString *)convertSubstituedToHTML:(NSString *)substitute withFontName:(NSString *)fontName pointSize:(CGFloat)pointSize textColor:(UIColor *)color</span><br></pre></td></tr></table></figure>
<h5 id="高度缓存"><a href="#高度缓存" class="headerlink" title="高度缓存"></a>高度缓存</h5><p>使用 <code>cellHeightForHTML</code> 方法获取消息的行高。 此方法缓存单元高度以提高性能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// determine row height with HTML</span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath &#123;</span><br><span class="line">    if (self.meTextInputView == nil) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NSDictionary * message = [self.messages objectAtIndex:indexPath.row];</span><br><span class="line">    return [self.meTextInputView cellHeightForHTML:[message objectForKey:@&quot;html&quot;]</span><br><span class="line">                                       atIndexPath:indexPath</span><br><span class="line">                                      maxCellWidth:self.tableView.frame.size.width</span><br><span class="line">                                         cellStyle:MECellStyleChat];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>您可以通过重置 <code>METextInputView</code> 上的 <code>cachedHeights</code> 属性来手动重置 <code>UITableViewCell</code> 高度缓存。</p>
<h5 id="表格单元格"><a href="#表格单元格" class="headerlink" title="表格单元格"></a>表格单元格</h5><p>使用<code>MEChatTableViewCell</code>，您可以使用setCellDisplay在左侧或右侧显示聊天气泡。 这应该发生在为每个消息设置您的HTML之前。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath &#123;</span><br><span class="line">        static NSString *CellIdentifier = @&quot;Cell&quot;;</span><br><span class="line"></span><br><span class="line">        MEChatTableViewCell  *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];</span><br><span class="line"></span><br><span class="line">        if (cell == nil) &#123;</span><br><span class="line">            cell = [[MEChatTableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // display chat cell on right side</span><br><span class="line">        [cell setCellDisplay:MECellDisplayRight];</span><br><span class="line"></span><br><span class="line">        // display chat cell on left side</span><br><span class="line">        if (indexPath.row % 2) &#123;</span><br><span class="line">            [cell setCellDisplay:MECellDisplayLeft];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        NSDictionary * message = [self.messages objectAtIndex:indexPath.row];</span><br><span class="line">        [cell setHTMLString:[message objectForKey:@&quot;html&quot;]];</span><br><span class="line"></span><br><span class="line">        return cell;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="Hypermoji-带有URL的表情符号"><a href="#Hypermoji-带有URL的表情符号" class="headerlink" title="Hypermoji - 带有URL的表情符号"></a>Hypermoji - 带有URL的表情符号</h4><p>我们已经创建了一种新的方式来共享内容，浏览网页，观看视频或听音乐，而不用离开Hypermoji的应用程序。</p>
<p>要在Hypermoji（具有URL链接的表情符号）上点击时显示网页，请使用 <code>didTapHypermoji</code> 委托回调</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// handle tapping of links (Hypermoji)</span><br><span class="line">-(void)meTextInputView:(METextInputView *)inputView didTapHypermoji:(NSString*)urlString &#123;</span><br><span class="line">      // open webview here</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="相机按钮"><a href="#相机按钮" class="headerlink" title="相机按钮"></a>相机按钮</h4><p>这是一个标准的UIButton，可以用图像或文本进行自定义。 要处理相机按钮的操作，请使用<code>didTapCameraButton</code>委托回调。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(void)meTextInputView:(METextInputView *)inputView didTapCameraButton:(UIButton*)cameraButton &#123;</span><br><span class="line">    // Present image controller</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h4><p>您可以通过在 <code>METextInputView</code> 上设置 <code>displayCameraButton</code> 属性来显示或隐藏内置摄像头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.meTextInputView.displayCameraButton = NO;</span><br></pre></td></tr></table></figure>
<p>您可以通过在 <code>METextInputView</code> 上设置 <code>displaySendButton</code> 属性来显示或隐藏内置的发送按钮</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.meTextInputView.displaySendButton = NO;</span><br></pre></td></tr></table></figure>
<p>使用<code>setFont</code>你可以设置你的文本输入的默认字体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self.meTextInputView setFont:[UIFont systemFontOfSize:20]];</span><br></pre></td></tr></table></figure>
<p>更改占位符文本的颜色</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.meTextInputView.placeholderLabel.textColor = [UIColor darkGrayColor];</span><br></pre></td></tr></table></figure>
<h4 id="控制锁定的类别"><a href="#控制锁定的类别" class="headerlink" title="控制锁定的类别"></a>控制锁定的类别</h4><p>您将需要侦听NSNotification <code>MECategorySelectedLockedCategory</code> 来确定什么时候锁定了一个类别。 要解锁一个类别，您需要调用 <code>[MakemojiSDK unlockCategory：@“category”]</code> 您可以收听 ‘MECategoryUnlockedSuccessNotification<code>和</code>MECategoryUnlockedFailedNotification` 以确定解锁呼叫是否成功。</p>
<h3 id="📝-应用程序提交"><a href="#📝-应用程序提交" class="headerlink" title="📝 应用程序提交"></a>📝 应用程序提交</h3><p>Makemoji SDK 使用IDFA跟踪ID来为您的应用程序中的视图，共享和点击进行归因。 将应用程序提交到 App Store 时，您需要检查“将此应用程序安装到以前投放的广告”选项。</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/7/1616f87bece6eb36?w=1264&amp;h=607&amp;f=png&amp;s=75271" alt=""></p>
<h3 id="😬-联系"><a href="#😬-联系" class="headerlink" title="😬 联系"></a>😬 联系</h3><ul>
<li>微信 : WhatsXie</li>
<li>邮件 : <a href="mailto:ReverseScale@iCloud.com" target="_blank" rel="noopener">ReverseScale@iCloud.com</a></li>
<li>博客 : <a href="https://reversescale.github.io">https://reversescale.github.io</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <div id="donation_div"></div>

<script src="../../../../js/vdonate.js"></script>
<script>
var a = new Donate({
  title: '如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作!', // 可选参数，打赏标题
  btnText: 'Donate', // 可选参数，打赏按钮文字
  el: document.getElementById('donation_div'),
  wechatImage: 'http://ghexoblogimages.oss-cn-beijing.aliyuncs.com/18-11-14/6067039.jpg',
  alipayImage: 'http://ghexoblogimages.oss-cn-beijing.aliyuncs.com/18-11-16/6997594.jpg'
});
</script>
      
      
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
      

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../../../2017/01/22/Open source library/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          使用 CocoaPods 对公有库开源和私有库组件
        
      </div>
    </a>
  
  
    <a href="../../../09/21/Design patterns iOS/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">iOS 开发中常用的设计模式</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#🤖-要求"><span class="nav-number">1.</span> <span class="nav-text">🤖 要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#🚀-准备开始"><span class="nav-number">2.</span> <span class="nav-text">🚀 准备开始</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#🎨-测试-UI-什么样子？"><span class="nav-number">3.</span> <span class="nav-text">🎨 测试 UI 什么样子？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#🎯-安装方法"><span class="nav-number">4.</span> <span class="nav-text">🎯 安装方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#安装"><span class="nav-number">4.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#设置你的-SDK-Key"><span class="nav-number">4.2.</span> <span class="nav-text">设置你的 SDK Key</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#🛠-配置"><span class="nav-number">5.</span> <span class="nav-text">🛠 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#设置"><span class="nav-number">5.1.</span> <span class="nav-text">设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#浮动输入"><span class="nav-number">5.2.</span> <span class="nav-text">浮动输入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分离的输入"><span class="nav-number">5.3.</span> <span class="nav-text">分离的输入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入大小变化"><span class="nav-number">5.4.</span> <span class="nav-text">输入大小变化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#发送消息"><span class="nav-number">5.5.</span> <span class="nav-text">发送消息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#显示消息"><span class="nav-number">5.6.</span> <span class="nav-text">显示消息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#替代文字"><span class="nav-number">5.6.1.</span> <span class="nav-text">替代文字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#高度缓存"><span class="nav-number">5.6.2.</span> <span class="nav-text">高度缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#表格单元格"><span class="nav-number">5.6.3.</span> <span class="nav-text">表格单元格</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hypermoji-带有URL的表情符号"><span class="nav-number">5.7.</span> <span class="nav-text">Hypermoji - 带有URL的表情符号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#相机按钮"><span class="nav-number">5.8.</span> <span class="nav-text">相机按钮</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义"><span class="nav-number">5.9.</span> <span class="nav-text">自定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#控制锁定的类别"><span class="nav-number">5.10.</span> <span class="nav-text">控制锁定的类别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#📝-应用程序提交"><span class="nav-number">6.</span> <span class="nav-text">📝 应用程序提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#😬-联系"><span class="nav-number">7.</span> <span class="nav-text">😬 联系</span></a></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2018 Technology All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				UV : <span id="busuanzi_value_site_uv"></span> |  
				PV : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../categories" class="mobile-nav-link">Categories</a>
  
    <a href="../../../../tags" class="mobile-nav-link">Tags</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/scripts.js"></script>




  <script src="../../../../js/dialog.js"></script>








	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Technology
          </div>
          <div class="panel-body">
            Copyright © 2018 Steven&#39;s Blog All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>